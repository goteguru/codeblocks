<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>JavaScript automatiz√°l√°s - 11. fejezet: Office automatiz√°l√°s (cloud)</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/theme/darcula.css">
  <link rel="stylesheet" href="codeblocks.css">
</head>

<body>
  <header>
    <h1>11. fejezet ‚Äì Office automatiz√°l√°s (Google Apps Script √©s Office Scripts)</h1>
    <p>
      Ebben a fejezetben kicsit megkapargatjuk, mit is jelent a felh≈ë alap√∫ <strong>irodai (office) automatiz√°l√°s</strong>, √©s
      hogyan tudunk <strong>JavaScript/TypeScript</strong> seg√≠ts√©g√©vel t√°bl√°zatokat, e-maileket √©s dokumentumokat
      programozottan kezelni. Persze ez egy el√©g komoly t√©ma, sok h√°tt√©rtud√°st ig√©nyel (de h√°t erre van az LLM),
      itt annyi a c√©l, hogy nagyj√°b√≥l:
      <em>milyen probl√©m√°kra j√≥ ez</em>, <em>milyen k√∂rnyezetben fut</em>, √©s <em>hogyan n√©z ki a k√≥d</em>.
    </p>
  </header>

  <main>

    <section>
      <h2>1. Mi az irodai automatiz√°l√°s?</h2>

      <article>
        <h3>1.1. Alapmodell: adat + esem√©ny + szab√°ly + automatikus m≈±velet</h3>
        <p>
          Irodai automatiz√°l√°s alatt azt √©rtj√ºk, amikor a t√°bl√°zat/≈±rlap/e-mail/dokumentum k√∂rnyezetben
          ism√©tl≈ëd≈ë (vagy emberi hib√°ra hajlamos) feladatokat <strong>programozott logik√°val</strong> v√©gz√ºnk el.
        </p>

        <p class="info">
          Teh√°t itt nem megmondod, hogy csin√°ld-ezt, csin√°ld-azt, hanem: <strong>valamilyen adat megv√°ltozik</strong> (vagy eltelt egy bizonyos id≈ë) ‚Üí
          <strong>lefut egy szab√°ly (rendszer)</strong> ‚Üí
          <strong>amire v√°laszul t√∂rt√©nik valami</strong> (jel√∂l√©s, sz√°m√≠t√°s, email, riport, f√°jlmozgat√°s, stb.).
        </p>
      </article>

      <article>
        <h3>1.2. Mire j√≥ ez nekem?</h3>
        <p>
          A felh≈ë alap√∫ irodai automatiz√°l√°s el√©g sz√©lesk√∂rben elterjedt, √©s 
	  minden val√≥sz√≠n≈±s√©g szerint csak m√©g jobban el fog. Sok esetben a megl√©v≈ë
	  UI-al is el tudjuk v√©gezni ezeket a feladatokat, csak √©ppen
          lass√∫, hibalehet≈ës√©g nagy, √©s rosszul sk√°l√°z√≥dik (egyszer ok√©, de 100x
	  m√°r nem sz√≠vesen csin√°ln√°d meg). P√°r gyakori, val√≥s eset:
        </p>

        <ul>
          <li><strong>Valid√°ci√≥</strong>: hib√°s form√°tum, hi√°nyz√≥ mez≈ëk, duplik√°ci√≥k jel√∂l√©se.</li>
          <li><strong>Riportol√°s</strong>: heti/havi √∂sszes√≠t≈ëk, dashboard-friss√≠t√©s.</li>
          <li><strong>√ârtes√≠t√©s</strong>: automatikus email/Teams √ºzenet, ha "valami t√∂rt√©nt".</li>
          <li><strong>≈∞rlap‚Üífeldolgoz√°s‚Üíarchiv√°l√°s</strong>: bek√ºld√©skor ellen≈ërz√©s, ment√©s Drive/SharePoint al√°.</li>
          <li><strong>Id≈ëz√≠tett friss√≠t√©s</strong>: API-b√≥l adat beolvas√°sa, t√°bl√°zat friss√≠t√©se naponta.</li>
        </ul>

        <p>
          Tulajdonk√©ppen a t√°bl√°zatb√≥l egy kicsi, de nagyon hasznos "mini-alkalmaz√°st" tudunk l√©trehozni.
        </p>
      </article>

      <article>
        <h3>1.3. Mi√©rt "felh≈ë"? Mi a k√ºl√∂nbs√©g?</h3>
        <p>
          Felh≈ëben a k√≥d jellemz≈ëen nem a saj√°t g√©peden fut, hanem a szolg√°ltat√≥ k√∂rnyezet√©ben.
          Ez t√∂bb k√∂vetkezm√©nnyel is j√°r:
        </p>

        <ul>
          <li>Nem kell telep√≠teni semmit, nincs saj√°t szervered: a platform adja a futtat√≥k√∂rnyezetet.</li>
          <li>A "f√°jlrendszer" helyett <strong>szolg√°ltat√°sok</strong> vannak (Drive/SharePoint, Gmail/Outlook, stb.).</li>
          <li>Az el√©r√©s <strong>jogosults√°gokhoz</strong> √©s <strong>scope</strong>-okhoz k√∂t√∂tt.</li>
          <li>A futtat√°st √°ltal√°ban<strong>triggerek</strong> ind√≠tj√°k (id≈ë, esem√©ny, workflow l√©p√©s).</li>
        </ul>
      </article>
    </section>

    <section>
      <h2>2. N√©pszer≈± platformok: Google Apps Script √©s Microsoft Office Scripts</h2>

      <article>
        <h3>2.1. K√∂z√∂s nevez≈ë</h3>
        <p>
          Mindk√©t megold√°s felh≈ëben fut, dokumentum-k√∂zpont√∫ (Sheets/Excel), √©s egy
          <strong>platform API-n kereszt√ºl</strong> √©rheted el az adatokat √©s a m≈±veleteket.
        </p>

        <p class="info">
          Itt nincs DOM (mint a b√∂ng√©sz≈ëben), √©s nincs f√°jlrendszer sem (vagy npm, √∫gy mint Node.js-ben).
          Az adott office platform objektummodellje az eg√©sz vil√°g. Ami ott van, az van, ami nincs az nincs.
        </p>
      </article>

      <article>
        <h3>2.2. Google Apps Script (GAS) </h3>
        <ul>
          <li>JavaScript-alap√∫ k√∂rnyezet Google felh≈ëben</li>
          <li>Nat√≠v integr√°ci√≥: Sheets, Drive, Gmail, Calendar</li>
          <li>Ind√≠t√°s: id≈ëz√≠tett trigger, ≈±rlap / t√°bl√°zat esem√©ny, vagy manu√°lis futtat√°s</li>
          <li>F≈ë bel√©p√©si pontok (API objektumok): <code>SpreadsheetApp</code>, <code>GmailApp</code>, <code>DriveApp</code></li>
        </ul>
      </article>

      <article>
        <h3>2.3. Microsoft Office Scripts </h3>
        <ul>
          <li>TypeScript/JavaScript jelleg≈± k√∂rnyezet Excel Online-ban</li>
          <li>Workflow integr√°ci√≥: Power Automate (Flows)</li>
          <li>F≈ë bel√©p√©si pont: <code>workbook</code> objektum (√©s azon bel√ºl worksheet/range)</li>
          <li>Er≈ës(ebb) t√≠pusoss√°g (TypeScript), ami seg√≠t a hib√°k megel≈ëz√©s√©ben</li>
        </ul>
	<p class="info">A TypeScript a JavaScript "b≈ëvitett v√°ltozata" ahol a v√°ltoz√≥knak
	√©s form√°lis param√©tereknek szigor√∫ t√≠pust √≠rhatsz el≈ë. Vagyis megmondhatod, 
	hogy az √∂sszead√°s f√ºggv√©nyed sz√°mokat (number) fogad, √©s akkor nem is lehet
	neki m√°st (pl. string) √°tadni.</p>
      </article>

      <article>
        <h3>2.4. K√ºl√∂nbs√©gek √∂sszefoglal√°sa</h3>
        <table>
          <thead>
            <tr>
              <th>Szempont</th>
              <th>Google Apps Script</th>
              <th>Office Scripts</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Nyelv</td>
              <td>JavaScript</td>
              <td>TypeScript (JS-szer≈±)</td>
            </tr>
            <tr>
              <td>Trigger</td>
              <td>Be√©p√≠tett triggerek (id≈ë/esem√©ny)</td>
              <td>Power Automate workflow-kkal tipikus</td>
            </tr>
            <tr>
              <td>√ñkosziszt√©ma</td>
              <td>Gmail/Drive/Calendar nat√≠v</td>
              <td>Teams/SharePoint/Office 365 nat√≠v</td>
            </tr>
            <tr>
              <td>Futtat√°s</td>
              <td>Google szerver</td>
              <td>Excel Online (felh≈ë)</td>
            </tr>
          </tbody>
        </table>
      </article>
    </section>

    <section>
      <h2>3. Alapvet≈ë k√ºl√∂nbs√©gek Node.js-hez √©s b√∂ng√©sz≈ëh√∂z k√©pest</h2>

      <article>
        <h3>3.1. Node.js vs Office felh≈ë runtime</h3>
        <p>
          A Node.js-t kor√°bban "lok√°lis automatiz√°l√°sra" haszn√°ltuk: f√°jlok, mapp√°k, parancsok, rendszerszint≈± m≈±veletek.
          Office automatiz√°l√°sn√°l a k√∂zeg teljesen m√°s.
        </p>

        <ul>
          <li><strong>Nincs</strong> (vagy er≈ësen limit√°lt) f√°jlrendszer-hozz√°f√©r√©s.</li>
          <li><strong>Nincs</strong> (vagy limit√°lt) NPM csomagol√°s ‚Äì nem √∫gy b≈ëv√≠tesz, mint Node-ban.</li>
          <li>A bel√©p√©si pont a <strong>dokumentum API</strong>, nem a rendszer.</li>
          <li>Az ind√≠t√°s jellemz≈ëen <strong>trigger / workflow</strong>, nem CLI parancs.</li>
        </ul>
      </article>

      <article>
        <h3>3.2. B√∂ng√©sz≈ë JS √©s Office felh≈ë elt√©r√©sei</h3>
        <p>
          B√∂ng√©sz≈ëben a "vil√°g" a HTML/DOM (gombok, mez≈ëk, elemek). Office automatiz√°l√°sn√°l a "vil√°g" a dokumentum:
          munkalapok, cell√°k, t√°bl√°k, form√°z√°sok.
        </p>
        <p>
	A felh≈ë dokumentumban:
        </p>

        <ul>
          <li>Nincs <code>document</code> objektum, nincs DOM.</li>
          <li>Nincs klasszikus UI: a fel√ºlet maga a t√°bl√°zat.</li>
          <li>A manipul√°ci√≥kat nem DOM elemekre, hanem <strong>range-ekre</strong> √©s <strong>cell√°kra</strong> alkalmazhatjuk.</li>
        </ul>
	<p>
          R√∂viden √©s t√∂m√∂ren:
        </p>
        <ul>
          <li><strong>B√∂ng√©sz≈ë</strong>: UI-k√∂zpont√∫ programoz√°s (DOM + eventek).</li>
          <li><strong>Node.js</strong>: rendszer-k√∂zpont√∫ automatiz√°l√°s (f√°jl, folyamat, parancs).</li>
          <li><strong>Office felh≈ë</strong>: dokumentum-k√∂zpont√∫ automatiz√°l√°s (range, t√°bl√°zat, trigger/workflow).</li>
        </ul>
      </article>
    </section>

    <section>
      <h2>4. Na j√≥, √©s hogy kell ezt csin√°lni?</h2>
      <p>
      H√°t el≈ësz√∂r is meg kell tanulni sok-sok f√ºggv√©nyt, objektumot √©s v√©gig kell olvasni a dokument√°ci√≥t... üòâ
      </p>
      <p>
      M√°rmint r√©gebben √∫gy kellett. Szerencs√©re ma m√°r vannak
      nagy nyelvi modellek, azok pedig ezt mind tudj√°k, √≠gy azt√°n nek√ºnk csak annyi a dolgunk, hogy
      √©rts√ºk mit csin√°lunk √©s j√≥ helyre m√°soljuk a k√≥dot. N√©zz√ºnk n√©h√°ny √≠zel√≠t≈ët! 
      </p>
      <p>Nem lesznek hossz√∫ak, ink√°bb csak r√∂vid p√©ld√°k, hogy l√°ssuk, hogy is n√©z ki egy ilyen automatiz√°l√°s.
      </p>
	<p>
	A k√≥dr√©szletekhez sz√ºks√©g lesz egy t√°bl√°zatkezel≈ëre (itt, ezen a html lapon nyilv√°n nem fogj√°k azt csin√°lni amire sz√°ntuk ≈ëket).
	Ak√°r ki is pr√≥b√°lhatod p√©ld√°ul google sheets-ben. 
	Nyiss meg egy √∫j t√°bl√°zatatot. √çrj bele p√°r adatot.
	A b≈ëv√≠tm√©nyek f√ºl alatt tal√°lsz egy App Scripts men√ºt (megnyit egy sz√©p editort).
	Ide tudod bem√°solni (√©s a futtat√°s gombbal futtatni) a f√ºggv√©nyeket. Mivel azonban a jogosults√°grendszerrel
	nem foglalkoztunk, a Google Workspace reklam√°lni fog, hogy a k√≥d "nem biztons√°gos"
	√©s csak akkor futtasd, ha megb√≠zol a k√©sz√≠t≈ëben. √çgy h√°t, amennyiben megb√≠zol magadban, akkor 
	a kis alig l√°that√≥ enged√©lyez√©s gombra kell majd b√∂kn√∂d √©s nem a hatalmas kiemelt "vissza a biztons√°ghoz"
	gombra, mert az nem fogja engedni, hogy futtasd.
	</p>
	<p>
	Mivel nem √°ll√≠totottunk be
	</p>

      <article>
        <h3>4.1. Google Apps Script - automatikus email k√ºld√©s a t√°bl√°zatb√≥l</h3>
        <p>
          Tegy√ºk fel, hogy a legutols√≥ sorban van egy e-mail c√≠m, √©s szeretn√©nk automatikusan k√ºldeni r√° egy √©rtes√≠t√©st.
        </p>
        <textarea data-lang="js">
function sendNotification() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const lastRow = sheet.getLastRow();

  const email = sheet.getRange(lastRow, 2).getValue(); // pl. B oszlop: email

  GmailApp.sendEmail(
    email,
    "√ârtes√≠t√©s",
    "Az adatod r√∂gz√≠tve lett."
  );
}
        </textarea>
	<p>L√°thatod, hogy a scriptben t√∂bb "glob√°lis" objektumot is
	haszn√°lunk (SpreasheetApp, GmailApp). A glob√°lis objektumnak
	t√∂bb tulajdons√°ga √©s met√≥dusa is van (hogy pontosan milyenek, azt a dokument√°ci√≥ban tal√°lod).
	A f√ºggv√©nyek (met√≥dusok) neve el√©g besz√©des.
	</p>
	<p>
	Az t√°bl√°zatkezel≈ë akt√≠v munkaf√ºzet√©b≈ël az akt√≠v lapot eltessz√ºk egy v√°ltoz√≥ba (√°ltal√°ban t√∂bbsz√∂r akarjuk majd haszn√°lni).
	Kik√©rj√ºk az utols√≥ sor sz√°m√°t, majd ennek seg√≠ts√©g√©vel kivessz√ºk a m√°sodik oszlopb√≥l az √©rt√©ket. 
	V√©g√ºl a GmailApp-al elk√ºldj√ºk.
	</p>
	<p>
	Nem is olyan bonyolult, nem igaz?
	</p>

      </article>

      <article>
        <h3>4.2. Alap√©rtelmezett √©rt√©k (ha √ºres a cella)</h3>
        <p>
          Ha egy cella √ºres (falsy), akkor adjunk neki alap√©rtelmezett √©rt√©ket.
        </p>
        <textarea data-lang="js">
function ensureDefault() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const cell = sheet.getRange("B2");

  const value = cell.getValue();
  if (!value) {
    cell.setValue(42);
  }
}
        </textarea>
      </article>

      <article>
        <h3>4.3. Office Scripts ‚Äì negat√≠v sz√°mok sz√≠nez√©se (Excel Online)</h3>
        <p>
          A haszn√°lt tartom√°nyt bej√°rjuk, √©s ha negat√≠v sz√°mot tal√°lunk, piros h√°tteret √°ll√≠tunk.
        </p>
        <textarea data-lang="js">
function main(workbook: ExcelScript.Workbook) {
  const sheet = workbook.getActiveWorksheet();
  const range = sheet.getUsedRange();
  const values = range.getValues();

  for (let r = 0; r &lt; values.length; r++) {
    for (let c = 0; c &lt; values[r].length; c++) {
      if (typeof values[r][c] === "number" && values[r][c] &lt; 0) {
        range.getCell(r, c)
          .getFormat()
          .getFill()
          .setColor("red");
      }
    }
  }
}
        </textarea>

        <p >
          Itt j√≥l l√°tszik a Microsoft f√©le megk√∂zel√≠t√©s: 
	  er≈ësen objektum-orient√°lt API, sok l√°ncolt h√≠v√°ssal
          (format/fill/color), valamint a main f√ºggv√©nyben
	  l√°thatod, hogy megadtuk a workbook t√≠pus√°t is.
        </p>
	<p class="info">
	A TypeScript meg√©rne egy k√ºl√∂n tanfolyamot, 
	itt most el√©g annyit megjegyezni, hogy kett≈ësponttal 
	tudjuk megmondani, hogy milyen t√≠pust
	gondolunk helyesnek az adott v√°ltoz√≥hoz/param√©terhez.
	</p>
      </article>

      <article>
        <h3>4.4. Office Scripts - √∂sszegz√©s gener√°l√°sa egy oszlopb√≥l</h3>
        <p>
          Sz√°m√≠tsunk ki valamit. Az A1:A10 tartom√°ny sz√°mait √∂sszeadjuk, majd az eredm√©nyt a B1 cell√°ba √≠rjuk.
	  Tudom, van erre f√ºggv√©ny, a j√≥ √∂reg sum(), ez most csak egy szuper egyszer≈± p√©lda. Idek√©pzelhetn√©nk b√°rmit amit a
	  javascript tud. P√©ld√°ul csin√°lhatn√°nk itt fokozatos k√∂zel√≠t√©st, maya napt√°rat, 
	  vagy ami esz√ºnkbe jut. 
        </p>
        <textarea data-lang="js" data-readonly>
function main(workbook: ExcelScript.Workbook) {
  const sheet = workbook.getActiveWorksheet();
  const range = sheet.getRange("A1:A10");
  const values = range.getValues();

  let sum = 0;

  for (let i = 0; i < values.length; i++) {
    const v = values[i][0];
    if (typeof v === "number") sum += v;
  }

  sheet.getRange("B1").setValue(sum);
}
        </textarea>
        <p>
	El tudtad olvasni a k√≥dot?
        </p>
      </article>

      <article>
        <p>
          A fejezet m√°sodik r√©sz√©ben ezeket a mint√°kat fogjuk haszn√°lni valamilyen form√°ban:
          triggerek, jogosults√°gok, t√°bl√°zat-strukt√∫ra, √©s tipikus "feladat pipeline-ok".
          Egyel≈ëre annyi volt a c√©l, hogy tiszt√°n l√°sd a gondolkod√°sm√≥dot.
        </p>
      </article>
    </section>

    <section>
      <h2>√ñsszefoglal√°s</h2>
      <ul>
        <li>Az office automatiz√°l√°s felh≈ëben <strong>dokumentum-k√∂zpont√∫</strong>.</li>
        <li>K√©t gyakori platform: <strong>Google Apps Script</strong> √©s <strong>Microsoft Office Scripts</strong>.</li>
        <li>Node.js-hez k√©pest nincs f√°jlrendszer + NPM jelleg≈± szabads√°g; b√∂ng√©sz≈ëh√∂z k√©pest nincs DOM.</li>
        <li>A k√≥d r√∂vid, de a l√©nyeg az <strong>API objektummodell</strong> √©s a <strong>triggerek/workflow</strong> meg√©rt√©se.</li>
      </ul>
    </section>

  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/javascript/javascript.min.js"></script>
  <script src="codeblocks.js"></script>
</body>
</html>
